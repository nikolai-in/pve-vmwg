# dnsmasq default configuration for VM subnet
# Generated by Ansible - DO NOT EDIT MANUALLY

except-interface=lo
enable-ra
quiet-ra
bind-dynamic
no-hosts
dhcp-leasefile=/var/lib/misc/dnsmasq.vmwgnat.leases
dhcp-hostsfile=/etc/dnsmasq.d/vmwgnat/ethers
# dhcp-ignore=tag:!known

# Adjusted MTU for better compatibility with both interfaces
dhcp-option=26,1380
ra-param=*,mtu:1380,0

# Send an empty WPAD option. This may be REQUIRED to get windows 7 to behave.
dhcp-option=252,"\n"

# Send microsoft-specific option to tell windows to release the DHCP lease
# when it shuts down. Note the "i" flag, to tell dnsmasq to send the
# value as a four-byte integer - that's what microsoft wants.
dhcp-option=vendor:MSFT,2,1i

# If a DHCP client claims that its name is "wpad", ignore that.
# This fixes a security hole. see CERT Vulnerability VU#598349
dhcp-name-match=set:wpad-ignore,wpad
dhcp-ignore-names=tag:wpad-ignore

# Add DNS configuration
dhcp-option=6,{{ vm_gateway }}
# Forward DNS queries to upstream resolvers
server=1.1.1.1
server=8.8.8.8
server=2606:4700:4700::1111

# Add logging for debugging
log-queries
log-dhcp
log-facility=/var/log/dnsmasq-vmwg.log

# Improve stability with more frequent lease updates
dhcp-lease-max=150
cache-size=1000
