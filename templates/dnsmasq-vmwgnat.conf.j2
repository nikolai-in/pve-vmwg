# dnsmasq configuration for vmwgnat instance
# Generated by Ansible - DO NOT EDIT MANUALLY

# Only operate on vmwg0 interface to avoid conflicts with Proxmox SDN
interface=vmwg0
except-interface=lo
bind-dynamic

# DHCP Configuration
dhcp-range={{ vm_dhcp_range_start }},{{ vm_dhcp_range_end }},255.255.255.0,12h
dhcp-option=option:router,{{ vm_gateway }}
dhcp-option=option:dns-server,{{ vm_gateway }}

# Lease and log files
dhcp-leasefile=/var/lib/misc/dnsmasq.vmwgnat.leases
dhcp-hostsfile=/etc/dnsmasq.d/vmwgnat/ethers

# DNS Configuration
server=1.1.1.1
server=8.8.8.8

# Network optimizations
dhcp-option=26,1380  # MTU
dhcp-option=252,"\n" # Empty WPAD option for Windows 7
dhcp-option=vendor:MSFT,2,1i # Microsoft option for proper DHCP release

# Security: ignore WPAD name claims
dhcp-name-match=set:wpad-ignore,wpad
dhcp-ignore-names=tag:wpad-ignore

# Stability and performance
dhcp-lease-max=150
cache-size=1000
no-hosts
enable-ra
quiet-ra

# Logging for debugging
log-queries
log-dhcp
log-facility=/var/log/dnsmasq-vmwg.log
